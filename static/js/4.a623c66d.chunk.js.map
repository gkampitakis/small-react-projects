{"version":3,"sources":["hooks/useFetch.ts","components/Error.tsx","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","projects/tours/components/Tour.tsx","projects/tours/components/Loading.tsx","projects/tours/Tours.tsx","projects/tours/Tours.spec.tsx"],"names":["useFetch","url","useState","loading","setLoading","error","setError","undefined","data","setData","retrieveData","useCallback","fetch","then","d","json","catch","e","finally","useEffect","Error","message","console","log","msg","className","src","alt","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","done","Promise","_asyncToGenerator","fn","self","this","args","arguments","apply","err","Tour","removeTour","more","setMore","image","name","price","substring","onClick","Loading","Tours","useBodyStyles","background","color","refetch","tours","setTours","map","tour","id","filter","length","fetchMock","describe","afterEach","cleanup","beforeEach","resetMocks","it","disableMocks","render","screen","getByText","expect","toBeTruthy","enableMocks","mockRejectOnce","waitFor","errorMessage","queryByText","a","mockResponseOnce","JSON","stringify","waitForElementToBeRemoved","toursElements","getAllByText","userEvent","click","queryAllByText","toBe"],"mappings":"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","file":"static/js/4.a623c66d.chunk.js","sourcesContent":["import { useEffect, useState, useCallback } from 'react';\n\n\nfunction useFetch<T> (url: string): [T | undefined, boolean, () => void, string | null] {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [data, setData] = useState(undefined);\n\n  const retrieveData = useCallback(() => {\n    setLoading(true);\n\n    fetch(url)\n      .then(d => d.json())\n      .then(d => setData(d))\n      .catch(e => setError(e))\n      .finally(() => setLoading(false))\n  }, [url]);\n\n  useEffect(() => {\n    retrieveData();\n  }, [retrieveData]);\n\n  return [data, loading, retrieveData, error];\n}\n\nexport { useFetch };\n","import React, { useEffect, ReactElement } from 'react';\n\n\ninterface ErrorProps {\n  error?: Error;\n  message?: string;\n}\n\n\nfunction Error ({ error, message }: ErrorProps): ReactElement {\n  useEffect(() => {\n    if (error)\n      console.log(error);\n  }, [error]);\n\n  const msg = message ? message : error?.message;\n\n  return (\n    <main className=\"error_component\">\n      <img src=\"./images/error.svg\" alt=\"Error page image\" />\n      <footer>\n        {\n          msg && <h2>{msg}</h2>\n        }\n        {\n          error && <p>You can check console for more information</p>\n        }\n      </footer>\n    </main >\n  );\n}\n\nexport default Error;\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","import React, { ReactElement, useState } from 'react'\nimport { TourI } from './interface';\n\n\nexport default function Tour (\n  { data, removeTour }: { data: TourI; removeTour: () => void }\n): ReactElement {\n  const [more, setMore] = useState(false);\n\n  return (\n    <article className=\"single-tour\">\n      <img src={data.image} alt={data.name} />\n      <footer>\n        <div className=\"tour-info\">\n          <h4>{data.name}</h4>\n          <h4 className=\"tour-price\">{data.price}</h4>\n        </div>\n        <p>\n          {more ? data.info : `${data.info.substring(0, 200)}...`}\n          <button onClick={() => setMore(!more)}>{more ? 'show less' : 'read more'}</button>\n        </p>\n        <button className=\"delete-btn\" onClick={removeTour}>Not interested</button>\n      </footer>\n    </article>\n  );\n}\n","import React, { ReactElement } from 'react'\n\n\nexport default function Loading (): ReactElement {\n  return (\n    <h2 className=\"loading\">Loading ...</h2>\n  );\n}\n","import React, { useState, useEffect, ReactElement } from 'react';\nimport { useFetch } from '../../hooks/useFetch';\nimport { useBodyStyles } from '../../hooks/useBodyStyles';\nimport { TourI } from './components/interface';\nimport Loading from './components/Loading';\nimport Error from '../../components/Error';\nimport Tour from './components/Tour';\nimport './index.scss';\n\n\nconst TOURS_DATA = 'https://course-api.com/react-tours-project';\n\nexport default function Tours (): ReactElement {\n  useBodyStyles({\n    background: 'hsl(210, 36%, 96%)',\n    color: 'hsl(209, 61%, 16%)'\n  });\n  const [data, loading, refetch, error] = useFetch(TOURS_DATA);\n  const [tours, setTours] = useState<TourI[]>([]);\n\n  function removeTour (id: string): void {\n    setTours((tours) => tours.filter(tour => tour.id !== id));\n  }\n\n  useEffect(() => {\n    setTours(data as TourI[]);\n  }, [data])\n\n  return (\n    <main className=\"tours\">\n      <div className=\"title\">\n        <h2>our tours</h2>\n        <div className=\"underline\"></div>\n      </div>\n      {\n        loading && <Loading /> ||\n        error && <Error message={error} /> ||\n        tours &&\n        <>\n          {tours.map(tour => (\n            <Tour key={tour.id} removeTour={() => removeTour(tour.id)} data={tour} />\n          ))\n          }\n          {\n            tours.length === 0 &&\n            <button className=\"refetch-btn\" onClick={refetch}>Refresh</button>\n          }\n        </>\n      }\n    </main>\n  );\n}\n","import React from 'react';\nimport { FetchMock } from 'jest-fetch-mock/types';\nimport userEvent from '@testing-library/user-event';\nimport { render, screen, cleanup, waitFor, waitForElementToBeRemoved } from '@testing-library/react';\nimport Tours from './Tours';\n\n\nconst fetchMock = (fetch as FetchMock);\n\ndescribe('Tours', () => {\n\n  afterEach(cleanup);\n  beforeEach(fetchMock.resetMocks);\n\n  it('Should start with loading', () => {\n    fetchMock.disableMocks();\n    render(<Tours />);\n\n    const loading = screen.getByText(/Loading/i);\n\n    expect(loading).toBeTruthy();\n  });\n\n  it('Should render error', (done) => {\n    fetchMock.enableMocks();\n\n    fetchMock.mockRejectOnce(() => Promise.reject('Mock Error'));\n    render(<Tours />);\n\n    const loading = screen.getByText(/Loading/i);\n\n    expect(loading).toBeTruthy();\n\n    waitFor(() => {\n      const errorMessage = screen.queryByText(/Mock Error/i);\n      expect(errorMessage).toBeTruthy();\n      done();\n    });\n  });\n\n  it('Should render tours list', async () => {\n    fetchMock.enableMocks();\n    fetchMock.mockResponseOnce(JSON.stringify(\n      [{\n        id: \"rec6d6T3q5EBIdCfD\",\n        name: \"Best of Paris in 7 Days Tour\",\n        info: \"mockInfo\",\n        image: \"https://dl.airtable.com/.attachments/a0cd0702c443f31526267f38ea5314a1/2447eb7a/paris.jpg\",\n        price: \"1,995\"\n      }]\n    ));\n\n    render(<Tours />);\n\n    await waitForElementToBeRemoved(screen.getByText(/Loading/i));\n\n    const toursElements = screen.getAllByText(/not interested/i);\n    expect(toursElements.length > 0).toBeTruthy();\n  });\n\n  it('Should remove tour from list', async () => {\n    fetchMock.enableMocks();\n    fetchMock.mockResponseOnce(JSON.stringify(\n      [{\n        id: \"rec6d6T3q5EBIdCfD\",\n        name: \"Best of Paris in 7 Days Tour\",\n        info: \"mockInfo\",\n        image: \"https://dl.airtable.com/.attachments/a0cd0702c443f31526267f38ea5314a1/2447eb7a/paris.jpg\",\n        price: \"1,995\"\n      }]\n    ));\n\n    render(<Tours />);\n    await waitForElementToBeRemoved(screen.getByText(/Loading/i));\n\n    userEvent.click(screen.getByText(/not interested/i));\n\n    const toursElements = screen.queryAllByText(/not interested/i);\n    expect(toursElements.length).toBe(0);\n  });\n})\n"],"sourceRoot":""}